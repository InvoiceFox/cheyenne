Cheyenne's Units Tests implementation notes - svn test

    Maxim Olivier-Adlhoch
    latest update: 2010-07-08
    applicable to cheyenne test-suite version 0.5.1


===Important notes:

* Current version of the testing engine expects v2.7.7 of REBOL.
* ALL code is implemented with Extensive reference to Internet RFCs, duly noted in the source where appropriate
* ALL HTTP/web code is implemented from scratch, using TCP sockets directly.  No internal web-handling REBOL code is used.
* The use of binary datatypes and modes is used in all TCP transfers, to ensure data integrity on network operations.




 
===Current Work in progress

---Finish low-level HTTP header tests

* Date:
* Server:

* URI equivalency, as per rfc 2616: item 3.2.3:
   Characters other than those in the "reserved" and "unsafe" sets (see
   RFC 2396 [42]) are equivalent to their ""%" HEX HEX" encoding.

   For example, the following three URIs are equivalent:

      http://abc.com:80/~smith/home.html
      http://ABC.com/%7Esmith/home.html
      http://ABC.com:/%7esmith/home.html
      
* rfc 2616: item 3.3 Date/Time Formats
* rfc 2616: item 3.4 Charset handling
* rfc 2616: item 3.5 Content Codings
* rfc 2616: item 3.6 Transfer Codings (implement chunked xfer?)
* rfc 2616: item 3.7 Media Types* 
* rfc 2616: item 3.10 Language Types > Accept-Language / Content-Language


HTTP METHODS to support:
"OPTIONS"                ; Section 9.2
"GET"                    ; Section 9.3
"HEAD"                   ; Section 9.4
"POST"                   ; Section 9.5
"PUT"                    ; Section 9.6
"DELETE"                 ; Section 9.7
"TRACE"                  ; Section 9.8
"CONNECT"                ; Section 9.9


GENERAL REQUEST FIELDS (request and response)
----
Cache-Control            ; Section 14.9
Connection               ; Section 14.10
Date                     ; Section 14.18
Pragma                   ; Section 14.32
Trailer                  ; Section 14.40
Transfer-Encoding        ; Section 14.41
Upgrade                  ; Section 14.42
Via                      ; Section 14.45
Warning                  ; Section 14.46



REQUEST FIELDS
----
Accept                   ; Section 14.1
Accept-Charset           ; Section 14.2
Accept-Encoding          ; Section 14.3
Accept-Language          ; Section 14.4
Authorization            ; Section 14.8
Expect                   ; Section 14.20
From                     ; Section 14.22
Host                     ; Section 14.23
If-Match                 ; Section 14.24
If-Modified-Since        ; Section 14.25
If-None-Match            ; Section 14.26
If-Range                 ; Section 14.27
If-Unmodified-Since      ; Section 14.28
Max-Forwards             ; Section 14.31
Proxy-Authorization      ; Section 14.34
Range                    ; Section 14.35
Referer                  ; Section 14.36
TE                       ; Section 14.39
User-Agent               ; Section 14.43


RESPONSE FIELDS
----
Accept-Ranges           ; Section 14.5
Age                     ; Section 14.6
ETag                    ; Section 14.19
Location                ; Section 14.30
Proxy-Authenticate      ; Section 14.33
Retry-After             ; Section 14.37
Server                  ; Section 14.38
Vary                    ; Section 14.44
WWW-Authenticate        ; Section 14.47


ENTITY FIELDS
---- 
Allow                    ; Section 14.7
Content-Encoding         ; Section 14.11
Content-Language         ; Section 14.12
Content-Length           ; Section 14.13
Content-Location         ; Section 14.14
Content-MD5              ; Section 14.15
Content-Range            ; Section 14.16
Content-Type             ; Section 14.17
Expires                  ; Section 14.21
Last-Modified            ; Section 14.29





---Testing engine

* Re-use previous unit test response as the basis for next one
* Redirection detection, testing, and follow-thru




===Itemized TO DO 

---Work in Progress

important items discovered/detailed while performing current work, will usually become work in progress 
since these items are required for prior implementation or potential show stoppers.

Known bugs/limitations will also be detailed here.

* Launching/grouping dialect
* GET url parameter passing
* POST html form parameter passing


---Don't forget

Items which fall in-between cracks which must not be forgotten, but not priority ATM.

These items might eventually be addressed since they make overall testing better, but do not prevent
the engine from working at its current implementation state.

Some of these will be bumped to "Work in Progress" as the engine evolves.

* Web socket request
* Improved reporting on test results


---Possible future improvements

Ideas which are collected while implementing, but which fall outside of current project outline.

* HTML/RSP page which runs & reports the full cheyenne self-test once a server is up and running.
* CSV or DB driven reporting of tests
* Itemized Launch GUI (desktop or web)
* Regression viewer GUI (desktop or web)
* Direct integration with cure-code, as regression/bug tickets




===Current Priorities (in order of implementation, top-down)

---HTTP protocol (priority 1)

Tests should be written using latest HTTP RFC (should be 2616) and other related RFCs as reference documentation.

* request line parsing
* client headers parsing and semantics
* server headers correctness
* adequate response codes
* correct HTTP1.0 answers (when client asks for 1.0)
* correct HTTP1.1 specific features support (like pipelining)


---Cheyenne (priority 2)

The following tests also include testing configuration keywords declared in each mod.

* mod-static specific features testing


---RSP (priority 3)

* POST data handling (with cheyenne's specific features tests)
* GET & POST data decoding (including multipart encoding)
* RSP API complete cover (http://cheyenne-server.org/docs/rsp-api.html)
* Webapp's events
* Webapps isolation
* Sessions life cycle


---CGI (priority 4)

* REBOL CGI's compliant interface (simulation of REBOL -cgi startup mode)
* General CGI compliance (using simple Perl CGI scripts from Perl's units tests)


---Cheyenne (priority 5)

The following tests also include testing configuration keywords declared in each mod.

* mod-ssi specific features testing
* mod-fastcgi & mod-extapp specific features testing (using PHP as backend)

---Environment (priority 6)
* OS specific tests




===History

As items are completed, they will be moved here, so we can easily keep tabs
on what is supposed to be working in order to detect & report bugs in the engine.

---GENERAL

* Split-up of testing code into separate files: unit.r, tests.r, classes.r & mezz.r


---HTTP protocol

* basic !unit test class
* http request header parsing & creation
* GET, POST, HEAD HTTP methods support in various !unit functions and callbacks
* unit test execute() model
* explicit control over use of HTTP 1.0 or 1.1 within testing
* capability to store request as SENT in addition to request data, so we can debug testing engine itself.
* request and response stored individually for comparison tests.
* /stop refinement to control if testing should continue or not after a failed test.
* TEST:  'CHECK-HEADER  verifies header tokens & status line for expected response values
* TEST:  'DO  run arbitrary REBOL code after a test is performed, for more complex failure assessment
* extensive source documentation of each and every property, function, and algorithm for posterity.
