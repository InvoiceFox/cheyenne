<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/html4/loose.dtd"><html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<title>Upload</title>		<style>			body      {font-family: sans-serif;font-size:0.9em;}			#progress {border: 1px silver solid;width:100px;height:20px;margin:20px;}			#bar      {background-color:green;width:0px;height:20px;}			#counter, #transfer  {margin:20px}		</style>		<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js'></script>		<script language="javascript" type="text/javascript">/*----------------------------------------------------------------------------	=== Cheyenne Upload API ===	--- Obtain an upload token ---		/upload/get-id		returns an integer token as string value.	--- Attach the token to the uploaded file ---		append '?token=<token ID>' to the form/action target so the server can		figure out the association.	--- Query the file upload progression ---		/upload/status/<token ID>		returns a JSON array of integers: {<percent>,<received>,<expected>},			<percent>: percent of upload accomplised so far (between 0-100)			<received>: amount of bytes received			<expected>: amount of bytes expected (file size)----------------------------------------------------------------------------*/			var token;			var timer;			function onTimer(){				//-- query the server with the token to get updated info				$.getJSON('/upload/status/' + token, function (stats){					$('#bar').css('width', String(stats[0]) + 'px');  //-- update the bar size					$('#counter').html(String(stats[0]) + ' %');	  //-- update the %					$('#transfer').html(String(stats[1]) + ' bytes'); //-- update the bytes amount					if (stats[0] < 100)					  //-- if upload not finished						timer = setTimeout(onTimer, 100); //-- keep querying every 100ms				})			}			function getToken (){				//-- get a new token using a blocking query				token = $.ajax({url: '/upload/get-id', async: false,}).responseText;				//-- add the ?token=<token ID> part to the target URL				$('#frm').attr('action', 'show.rsp?token=' + token);				//-- use a delayed call to initiate the upload progress probing				timer = setTimeout(onTimer, 100);				return true;			}		</script>	</head>	<body>		<form id="frm" target="_hiddenframe" method="post"enctype="multipart/form-data">			<input type="file" name="ufile" size="16" />			<input type="submit" name="usubmit" value="upload" onClick="getToken();" />		</form>		<div id="progress"><div id="bar"></div></div>		<span id="counter">0 %</span>		<br>		<span id="transfer">0 bytes</span>		<!-- this hidden IFRAME is used as target for the FORM -->		<iframe name="_hiddenframe" style="display:none"></iframe>	</body></html>